<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Image Recognition Chatbot</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>

<body class="app-body">
  <div class="app-container">
    <!-- Left Sidebar -->
    <div class="sidebar">
      <div class="sidebar-header">
        <div class="logo" style="
              margin-bottom: 1.5rem;
              display: flex;
              align-items: center;
              gap: 0.75rem;
            ">
          <img src="logo.png" alt="ObsidianAI Logo" style="width: 32px; height: 32px; object-fit: contain;">
          <span style="font-size: 1.25rem; font-weight: 800">ObsidianAI</span>
        </div>

        <div class="sidebar-actions">
          <button class="sidebar-btn primary" onclick="createNewChat()">
            <span class="icon">+</span> New Chat
          </button>
          <button class="sidebar-btn secondary" onclick="toggleSearch()">
            Search Chats
          </button>
          <button class="sidebar-btn secondary" onclick="toggleArchivedView()">
            <span id="archive-toggle-text">Show Archived</span>
          </button>
        </div>
      </div>

      <div id="search-container" class="search-container" style="display: none; padding: 0 20px 15px 20px">
        <input type="text" id="search-input" placeholder="Search chats..." oninput="searchChats()" style="
              width: 100%;
              padding: 12px;
              background: #1a1a1a;
              border: 1px solid #333;
              border-radius: 10px;
              color: #fff;
            " />
      </div>

      <div style="
            padding: 10px 25px 5px 25px;
            color: #888;
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
          ">
        Your Chats
      </div>
      <div class="chats-list" id="chats-list">
        <!-- Chats will be loaded here -->
      </div>

      <div class="sidebar-footer">
        <button class="footer-btn" onclick="showSettings()">
          <span class="icon">⚙</span> Settings
        </button>
        <button class="footer-btn logout" onclick="logout()">
          <span class="icon">→</span> Logout
        </button>
      </div>
    </div>

    <!-- Main Content Area -->
    <div class="main-content">
      <div class="chat-header">
        <div style="display: flex; align-items: center; gap: 15px">
          <div class="chat-actions">
            <button class="action-btn" onclick="showChatMenu()" id="chat-menu-btn">
              ⋯
            </button>
            <div class="dropdown-menu" id="chat-menu" style="display: none; left: 0; right: auto">
              <button onclick="archiveCurrentChat()">Archive</button>
              <button onclick="deleteCurrentChat()" class="danger">
                Delete
              </button>
            </div>
          </div>
          <h2 id="chat-title" onclick="renameChat()" style="cursor: pointer; user-select: none" title="Click to rename">
            New Chat
          </h2>
        </div>
      </div>

      <div class="messages-container" id="messages-container">
        <div class="welcome-message" id="welcome-screen">
          <div class="welcome-icon">
            <svg viewBox="0 0 32 32" aria-hidden="true" style="width: 80px; height: 80px; fill: white;">
              <circle cx="16" cy="16" r="12" />
              <circle cx="16" cy="16" r="6" fill="none" stroke="white" stroke-width="2" />
            </svg>
          </div>
          <h3>Welcome to ObsidianAI</h3>
          <p>Your intelligent companion for notes and insights.</p>
          <div class="welcome-actions">
            <p>Drag and drop files here or start typing below</p>
          </div>
        </div>
      </div>

      <div id="drop-overlay" class="drop-overlay">
        <div class="drop-overlay-content">
          <div class="drop-icon">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
              stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="17 8 12 3 7 8"></polyline>
              <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
          </div>
          <h2>Drop files to upload to ObsidianAI</h2>
          <p>Images and PDFs are supported</p>
        </div>
      </div>

      <div class="input-container">
        <div class="input-wrapper">
          <input type="file" id="image-input" accept="image/*,.pdf" multiple style="display: none"
            onchange="handleFileUpload(event)" />
          <input type="text" id="message-input" placeholder="Ask anything..." onkeypress="handleKeyPress(event)"
            onpaste="handlePaste(event)" />
          <button class="image-btn" onclick="document.getElementById('image-input').click()" title="Upload Files">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
              stroke-linecap="round" stroke-linejoin="round">
              <path
                d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48">
              </path>
            </svg>
          </button>
          <button class="send-btn" onclick="sendMessage()">Send</button>
        </div>
        <div id="file-preview" class="file-preview"></div>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div id="settings-modal" class="modal" style="display: none">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Account Settings</h3>
        <button class="close-btn" onclick="closeSettings()">✕</button>
      </div>
      <div class="modal-body">
        <div class="setting-item">
          <label>Account Name</label>
          <input type="text" id="account-username" readonly class="setting-input" />
        </div>
        <div class="setting-item">
          <label>Email</label>
          <input type="email" id="account-email" readonly class="setting-input" />
        </div>
        <div class="setting-item">
          <label>AI Memory & Preferences</label>
          <p class="help-text" style="
                margin-bottom: 0.5rem;
                font-size: 0.85rem;
                color: var(--text-light);
              ">
            Set preferences, context, or instructions that the AI will
            remember across all chats. Examples: "Always respond in a friendly
            tone", "I'm a software developer", "Use simple language", etc.
          </p>
          <textarea id="user-memory" placeholder="Enter your preferences, context, or instructions here..."
            class="setting-input" rows="6" style="resize: vertical; min-height: 120px; font-family: inherit"></textarea>
          <button onclick="saveUserMemory()" class="save-btn" style="margin-top: 0.75rem">
            Save Memory
          </button>
          <p id="memory-save-message" class="help-text" style="margin-top: 0.5rem; display: none"></p>
        </div>
        <div class="setting-item">
          <label>Reset Password</label>
          <div class="password-reset-section">
            <input type="password" id="current-password" placeholder="Current password" class="setting-input" />
            <input type="password" id="new-password" placeholder="New password" class="setting-input" />
            <input type="password" id="confirm-password" placeholder="Confirm new password" class="setting-input" />
            <button onclick="resetPassword()" class="save-btn">
              Reset Password
            </button>
            <p id="password-reset-message" class="help-text" style="margin-top: 0.5rem; display: none"></p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="home.js"></script>
</body>

</html>